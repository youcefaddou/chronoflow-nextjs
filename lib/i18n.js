import i18n from "i18next";
import { initReactI18next } from "react-i18next";

// Détection de la langue à partir de l'URL, query params, ou localStorage
function detectLanguage() {
  if (typeof window !== "undefined") {
    // 1. Check URL query parameters first (?lang=en)
    const urlParams = new URLSearchParams(window.location.search);
    const langParam = urlParams.get('lang');
    if (langParam && (langParam === 'en' || langParam === 'fr')) {
      localStorage.setItem('preferred-language', langParam);
      return langParam;
    }

    // 2. Check URL path (/en/...)
    if (window.location.pathname.startsWith("/en")) {
      localStorage.setItem('preferred-language', 'en');
      return "en";
    }

    // 3. Check localStorage
    const savedLang = localStorage.getItem('preferred-language');
    if (savedLang && (savedLang === 'en' || savedLang === 'fr')) {
      return savedLang;
    }

    // 4. Check browser language
    const browserLang = navigator.language || navigator.userLanguage;
    if (browserLang.startsWith('en')) {
      return 'en';
    }
  }
  return "fr"; // Default fallback
}

const initialLang = detectLanguage();

i18n
  .use(initReactI18next)
  .init({
    resources: {
      fr: {
        translation: {
          // Ajoute tes clés/valeurs ici
          "header.product": "Produit",
          "header.pricing": "Tarifs",
          "header.resources": "Ressources",
          "header.dashboard": "Tableau de bord",
          "header.login": "Connexion",
          "header.signup": "S'inscrire",
          "header.logout": "Se déconnecter",
          // Footer
          "footer.product": "Produit",
          "footer.pricing": "Tarifs",
          "footer.resources": "Ressources",
          "footer.help": "Aide",
          "footer.faq": "FAQ",
          "footer.contact": "Contact",
          "footer.legal": "Légal",
          "footer.legalNotice": "Mentions légales",
          "footer.privacyPolicy": "Politique de confidentialité",
          "footer.terms": "Conditions d'utilisation",
          "footer.rights": "Tous droits réservés.",
          // Authentication
          "auth.signup.title": "Créer un compte",
          "auth.signup.email": "Email",
          "auth.signup.emailInvalid": "Email invalide",
          "auth.signup.username": "Nom d'utilisateur",
          "auth.signup.usernameRequired": "Nom d'utilisateur requis",
          "auth.signup.password": "Mot de passe",
          "auth.signup.passwordMinLength": "Le mot de passe doit contenir au moins 8 caractères",
          "auth.signup.passwordFormat": "Le mot de passe doit contenir une majuscule, une minuscule, un chiffre et un caractère spécial",
          "auth.signup.confirmPassword": "Confirmer le mot de passe",
          "auth.signup.creating": "Création...",
          "auth.signup.create": "Créer un compte",
          "auth.signup.success": "Compte créé avec succès !",
          "auth.signup.hasAccount": "Déjà un compte ?",
          "auth.signup.signIn": "Se connecter",
          "auth.login.title": "Connexion",
          "auth.login.password": "Mot de passe",
          "auth.login.emailInvalid": "Email invalide",
          "auth.login.passwordMinLength": "Le mot de passe doit contenir au moins 8 caractères",
          "auth.login.passwordFormat": "Le mot de passe doit contenir une majuscule, une minuscule, un chiffre et un caractère spécial",
          "auth.login.signing": "Connexion...",
          "auth.login.signIn": "Se connecter",
          "auth.login.googleSignIn": "Se connecter avec Google",
          "auth.login.noAccount": "Pas de compte ?",
          "auth.login.createAccount": "Créer un compte",
          "auth.login.signing": "Connexion...",
          "auth.login.signIn": "Se connecter",
          "auth.login.googleSignIn": "Se connecter avec Google",
          "auth.login.noAccount": "Pas encore de compte ?",
          "auth.login.createAccount": "Créer un compte",
          "auth.loading": "Chargement...",
          "auth.userNotConnected": "Utilisateur non connecté",
          // OAuth error messages
          "auth.errors.oauthInvalidGrant": "Erreur d'authentification Google. Veuillez réessayer.",
          "auth.errors.googleAuthError": "Erreur lors de l'authentification Google.",
          "auth.errors.authFailed": "Échec de l'authentification.",
          "auth.errors.missingCode": "Code d'autorisation manquant.",
          "auth.errors.unknown": "Une erreur s'est produite lors de l'authentification.",
          // Features
          "features.title": "Fonctionnalités clés",
          "features.timerTitle": "Timer intelligent",
          "features.timerDesc": "Démarrez, arrêtez et suivez votre temps facilement.",
          "features.tasksTitle": "Gestion des tâches",
          "features.tasksDesc": "Organisez vos tâches et priorisez vos journées.",
          "features.statsTitle": "Statistiques visuelles",
          "features.statsDesc": "Visualisez vos progrès avec des graphiques clairs.",
          "features.calendarTitle": "Intégration Google Calendar",
          "features.calendarDesc": "Synchronisez vos événements et tâches.",
          "features.securityTitle": "Sauvegarde sécurisée",
          "features.securityDesc": "Vos données sont protégées et sauvegardées.",
          // Hero
          "hero.title": "Gérez votre temps et vos tâches efficacement avec ChronoFlow",
          "hero.subtitle": "ChronoFlow est la solution moderne pour organiser vos journées, suivre vos projets et booster votre productivité. Profitez d'une interface intuitive, d'une sécurité optimale et d'une gestion du temps simplifiée, où que vous soyez.",
          "hero.cta": "Créer un compte",
          // How it works
          "howitworks.title": "Comment ça marche ?",
          "howitworks.step1Title": "Démarrez le timer",
          "howitworks.step1Desc": "Lancez votre session de travail en un clic.",
          "howitworks.step2Title": "Ajoutez vos tâches",
          "howitworks.step2Desc": "Notez et organisez vos tâches à accomplir.",
          "howitworks.step3Title": "Analysez vos progrès",
          "howitworks.step3Desc": "Consultez vos statistiques et améliorez-vous.",
          // Sidebar & Dashboard navigation
          "sidebar.workspace": "Espace de travail",
          "sidebar.organization": "Organisation",
          "sidebar.settings": "Paramètres",
          "sidebar.subscription": "Abonnement",
          "sidebar.navigation": "Navigation",
          "sidebar.account": "Compte",
          "sidebar.dashboard": "Tableau de bord",
          "sidebar.calendar": "Calendrier",
          "sidebar.timer": "Minuteur",
          // Calendar
          "calendar.today": "Aujourd'hui",
          "calendar.yesterday": "Hier",
          "calendar.thisWeek": "Cette semaine - S{week}",
          "calendar.lastWeek": "Semaine dernière - S{week}",
          "calendar.custom": "Date personnalisée",
          "calendar.next": "Semaine suivante",
          "calendar.prev": "Semaine précédente",
          "calendar.calendar": "Calendrier",
          "calendar.listView": "Liste",
          "calendar.timesheet": "Feuille de temps",
          // Dashboard          
          "dashboard.welcome": "Bienvenue dans votre espace de travail",
          "dashboard.calendar": "Calendrier",
          "dashboard.tasks": "Tâches",
          "dashboard.focusZone": "Zone de focus",
          "dashboard.focus": "Focus", "dashboard.import": "Importer",
          "dashboard.importCalendar": "Importer calendrier",
          "dashboard.export": "Exporter",
          "dashboard.exportTasks": "Exporter les tâches",
          "dashboard.calendarPlaceholder": "Calendrier en cours de chargement...",
          "dashboard.getInTheZone": "Entrez dans la zone",
          "dashboard.focusMessage": "Restez concentré et évitez les distractions. Vous êtes dans la zone !",
          // Traductions calendrier
          "dashboard.calendar.title": "Calendrier",
          "dashboard.calendar.view": "Calendrier",
          "dashboard.calendar.importGoogle": "Importer Google",
          "dashboard.calendar.today": "Aujourd'hui",
          "dashboard.calendar.month": "Mois",
          "dashboard.calendar.week": "Semaine",
          "dashboard.calendar.day": "Jour",
          "dashboard.calendar.list": "Liste",
          // Traductions tâches
          "dashboard.tasks.title": "Titre",
          "dashboard.tasks.description": "Description",
          "dashboard.tasks.color": "Couleur",
          "dashboard.tasks.chooseColor": "Choisir la couleur",
          "dashboard.tasks.create": "Créer une tâche",
          "dashboard.tasks.edit": "Modifier la tâche",
          "dashboard.tasks.delete": "Supprimer",
          "dashboard.tasks.cancel": "Annuler",
          "dashboard.tasks.save": "Enregistrer",
          "dashboard.tasks.list": "Liste",
          "dashboard.taskStates": {
            "all": "Toutes",
            "active": "Actives",
            "completed": "Terminées"
          },
          "dashboard.loading": "Chargement...",

          // Section des tâches
          "tasks.taskList": "Liste des tâches",
          "tasks.addTask": "Ajouter une tâche",
          "tasks.editTask": "Modifier la tâche",
          "tasks.taskTitle": "Titre de la tâche",
          "tasks.taskDescription": "Description de la tâche (optionnel)",
          "tasks.noTasks": "Aucune tâche à afficher.",
          "tasks.finish": "Terminer",
          "tasks.completed": "Terminé",
          "tasks.startTimer": "Démarrer le timer",
          "tasks.pauseTimer": "Pause",
          "tasks.resumeTimer": "Reprendre",
          "tasks.stopTimer": "Arrêter le timer",

          // Timer
          "timer.title": "Chronomètre",
          "timer.start": "Démarrer",
          "timer.pause": "Pause",
          "timer.resume": "Reprendre",
          "timer.stop": "Arrêter",
          "timer.reset": "Remettre à zéro",
          "timer.running": "En cours",
          "timer.paused": "En pause",
          "timer.currentTask": "Tâche en cours",
          "timer.noTask": "Aucune tâche sélectionnée",
          "timer.saveSession": "Sauvegarder la session",
          "timer.timeElapsed": "Temps écoulé",
          "timer.taskTitle": "Nom de la tâche",
          "timer.taskTitlePlaceholder": "Ex: Développement feature X",
          "timer.taskDescription": "Description",
          "timer.taskDescriptionPlaceholder": "Détails sur le travail effectué...",

          // Focus Zone
          "focusZone.title": "Zone de focus",
          "focusZone.searchPlaceholder": "Rechercher une tâche...",
          "focusZone.createNew": "Créer une nouvelle tâche",
          "focusZone.newTaskPlaceholder": "Nom de la nouvelle tâche...",
          "focusZone.startWithoutTask": "Démarrer sans tâche",
          "focusZone.noResults": "Aucune tâche trouvée",
          // Common
          "common.back": "Retour",
          "common.cancel": "Annuler",
          "common.loading": "Chargement...",
          "common.save": "Enregistrer",
          "common.edit": "Modifier",
          "common.delete": "Supprimer",
          "common.optional": "optionnel",
          "common.notConnected": "Non connecté",
          // Settings extended
          "settings.subtitle": "Gérez vos préférences et paramètres de compte",
          "settings.connectedDevices": "Appareils connectés",
          "settings.loginHistory": "Historique des connexions",
          "settings.noDevices": "Aucun appareil connecté.",
          "settings.noRecentLogins": "Aucune connexion récente.",
          "settings.device": "Appareil",
          "settings.ip": "IP",
          "settings.browser": "Navigateur",
          "settings.date": "Date",
          "settings.connectedOn": "Connecté le",
          //export
          'export.errorLoadingLib': 'Erreur lors du chargement des librairies d’export. Veuillez réessayer.',
          'export.exportError': 'Erreur lors de l’export. Veuillez réessayer.',
          'export.title': 'Exporter les tâches',
          'export.format': 'Format d\'export',
          'export.csv': 'CSV (Tableur)',
          'export.pdf': 'PDF (Document)',
          'export.report': 'Rapport de productivité',
          'export.tasksCount': '{{count}} tâches à exporter',
          'export.export': 'Exporter',
          'export.cancel': 'Annuler',
          'export.exporting': 'Export en cours...',
          'export.csvDesc': 'Format simple pour l\'analyse dans Excel/Google Sheets',
          'export.pdfDesc': 'Document formaté, idéal pour l\'archivage',
          'export.reportDesc': 'Rapport détaillé avec analyses et statistiques',

          // Task actions
          "task.complete": "Terminer la tâche",
          "task.completed": "Terminée",
          // Timer actions
          "timer.start": "Démarrer",
          "timer.play": "Démarrer",
          "timer.pause": "Pause",
          "timer.resume": "Reprendre",
          "timer.stop": "Arrêter",
          "project.time": "Temps",
          // Settings
          settings: {
            title: 'Paramètres',
            userProfile: 'Profil utilisateur',
            preferences: 'Préférences',
            security: 'Sécurité',
            integrations: 'Intégrations',
            support: 'Support',
            others: 'Autres', items: {
              name: 'Nom',
              email: 'Email',
              password: 'Mot de passe',
              language: 'Langue',
              languageDesc: 'Choisissez votre langue préférée pour l\'interface',
              languageChanged: 'Langue modifiée avec succès',
              languageChangeError: 'Erreur lors du changement de langue',
              notifications: 'Notifications',
              notificationsDesc: 'Recevez des notifications pour vos tâches et rappels',
              notificationsEnabled: 'Notifications activées',
              notificationsDisabled: 'Notifications désactivées',
              notificationsOn: 'Activées',
              notificationsOff: 'Désactivées',
              profileLoadError: 'Erreur lors du chargement du profil',
              usernameRequired: 'Le nom d\'utilisateur est requis',
              usernameUpdated: 'Nom d\'utilisateur mis à jour avec succès',
              usernameUpdateError: 'Erreur lors de la mise à jour',
              emailNotEditable: 'Non modifiable',
              createdAt: 'Créé le',
              lastSignInAt: 'Dernière connexion le',
              changePassword: 'Changer le mot de passe',
              changePasswordDesc: 'Modifiez votre mot de passe pour sécuriser votre compte',
              oldPassword: 'Ancien mot de passe',
              newPassword: 'Nouveau mot de passe',
              confirmPassword: 'Confirmer le mot de passe',
              allFieldsRequired: 'Tous les champs sont requis',
              passwordMismatch: 'Les mots de passe ne correspondent pas',
              passwordTooShort: 'Le mot de passe doit contenir au moins 6 caractères',
              passwordChanged: 'Mot de passe modifié avec succès',
              passwordChangeError: 'Erreur lors du changement de mot de passe',
              googleCalendarConnected: 'Google Calendar connecté avec succès !',
              googleCalendarDisconnected: 'Google Calendar déconnecté avec succès.',
              googleCalendarError: 'Erreur lors de la connexion à Google Calendar.',
              disconnectGoogleCalendar: 'Déconnecter Google Calendar',
              faq: 'FAQ',
              faqDesc: 'Trouvez des réponses aux questions fréquemment posées',
              documentation: 'Documentation',
              documentationDesc: 'Consultez la documentation complète de ChronoFlow',
              contactSupport: 'Contacter le support',
              contactSupportDesc: 'Contactez notre équipe de support pour obtenir de l\'aide',
              exportData: 'Exporter les données',
              exportDataDesc: 'Téléchargez toutes vos données personnelles (tâches, temps de travail, paramètres) au format JSON.',
              deleteData: 'Supprimer les données',
              deleteDataDesc: 'Supprimez définitivement toutes vos données. Cette action est irréversible.',
              deleteWarning: 'Attention',
              deleteWarningText: 'Cette action supprimera définitivement toutes vos données. Tapez "SUPPRIMER" pour confirmer.',
              deleteConfirmError: 'Veuillez taper "SUPPRIMER" pour confirmer',
              exportSuccess: 'Données exportées avec succès',
              exportError: 'Erreur lors de l\'export des données',
              deleteSuccess: 'Données supprimées avec succès',
              deleteError: 'Erreur lors de la suppression des données',
              exporting: 'Export en cours...',
              deleting: 'Suppression...',
              confirmDelete: 'Confirmer la suppression',
              openLink: 'Ouvrir',
              openForm: 'Contacter',
              subject: 'Objet',
              message: 'Message',
              subjectPlaceholder: 'Objet de votre message',
              messagePlaceholder: 'Décrivez votre question ou problème...',
              emailPlaceholder: 'votre@email.com',
              contactFormError: 'Veuillez remplir tous les champs',
              contactSuccess: 'Message envoyé avec succès. Nous vous répondrons dans les plus brefs délais.',
              contactError: 'Erreur lors de l\'envoi du message. Veuillez réessayer.',
              sending: 'Envoi...',
              sendMessage: 'Envoyer',
            },
          },
          // Google Calendar
          googleCalendar: {
            title: 'Google Calendar',
            description: 'Connecte ton compte Google Calendar pour synchroniser tes tâches.',
            connect: 'Connecter Google Calendar',
            connecting: 'Connexion...',
            connected: 'Google Calendar connecté',
          },
          // FAQ
          "faq.title": "Questions fréquemment posées",
          "faq.subtitle": "Trouvez rapidement les réponses à vos questions sur ChronoFlow",
          "faq.question1": "Comment fonctionne ChronoFlow ?",
          "faq.answer1": "ChronoFlow vous permet de gérer votre temps et vos tâches simplement. Démarrez le timer pour suivre votre temps de travail, créez et organisez vos tâches, puis consultez vos statistiques pour améliorer votre productivité. Tout est conçu pour être intuitif et efficace.",
          "faq.question2": "Mes données sont-elles protégées ?",
          "faq.answer2": "Oui, vos données sont stockées en Europe et protégées conformément au RGPD. Nous utilisons des protocoles de sécurité avancés et vos informations personnelles ne sont jamais partagées avec des tiers.",
          "faq.question3": "Comment contacter l'équipe ?",
          "faq.answer3": "Vous pouvez nous écrire via la page Contact ou par email à contact.chronoflow@gmail.com. Notre équipe vous répond généralement sous 24h.",
          "faq.question4": "Puis-je synchroniser ChronoFlow avec Google Calendar ?",
          "faq.answer4": "Absolument ! ChronoFlow offre une intégration complète avec Google Calendar. Vous pouvez synchroniser vos événements, créer des tâches directement depuis vos rendez-vous et suivre le temps passé sur chaque activité calendaire.",
          "faq.question5": "ChronoFlow est-il gratuit ?",
          "faq.answer5": "ChronoFlow propose une version gratuite avec les fonctionnalités essentielles : timer, gestion de tâches de base et statistiques simples. Pour des fonctionnalités avancées comme l'intégration Google Calendar, les rapports détaillés et la collaboration en équipe, nous proposons des plans premium abordables.", "faq.noAnswer": "Vous ne trouvez pas votre réponse ?",
          "faq.contactTeam": "Notre équipe est là pour vous aider. N'hésitez pas à nous contacter !",
          "faq.contactButton": "Nous contacter",
          // Home components
          "home.faq.title": "Questions Fréquentes",
          "home.faq.subtitle": "Découvrez les réponses aux questions les plus courantes sur ChronoFlow",
          "home.faq.question1": "ChronoFlow est-il disponible en anglais ?",
          "home.faq.answer1": "Oui, vous pouvez cliquer sur le drapeau et profiter des fonctionnalités en anglais. L'interface s'adapte automatiquement à votre langue préférée.",
          "home.faq.question2": "Mes données sont-elles sécurisées ?",
          "home.faq.answer2": "Vos données sont stockées en Europe et protégées selon les normes RGPD. Nous utilisons un chiffrement de bout en bout et des serveurs sécurisés pour garantir la confidentialité de vos informations.",
          "home.faq.question3": "Puis-je connecter mon Google Calendar ?",
          "home.faq.answer3": "Oui, l'intégration Google Calendar est disponible pour synchroniser vos événements. Vous pouvez importer vos rendez-vous et synchroniser automatiquement votre planning.",
          "home.faq.moreQuestions": "Vous avez d'autres questions ?",
          "home.faq.contactUs": "Nous contacter",
          "home.testimonials.title": "Ils utilisent ChronoFlow",
          "home.testimonials.testimonial1.text": "\"ChronoFlow m'aide à rester concentré et à mieux gérer mes journées.\"",
          "home.testimonials.testimonial1.name": "Alice, Freelance",
          "home.testimonials.testimonial2.text": "\"L'interface est super intuitive, je recommande à 100%.\"",
          "home.testimonials.testimonial2.name": "Karim, Étudiant",
          "home.testimonials.testimonial3.text": "\"Les statistiques sont top pour suivre mes progrès.\"",
          "home.testimonials.testimonial3.name": "Sophie, Manager",
          "home.cta.title": "Prêt à booster votre productivité ?",
          "home.cta.subtitle": "Essayez ChronoFlow gratuitement dès aujourd'hui.",
          "home.cta.button": "Créer un compte",
          // Common navigation
          "common.previous": "Précédent",
          "common.next": "Suivant",
          "common.close": "Fermer",
          // Visual preview section
          "home.visual.preview1.title": "Gestion du temps",
          "home.visual.preview1.desc": "Visualisez et contrôlez votre temps de travail grâce à l'interface intuitive du timer.",
          "home.visual.preview1.alt": "Aperçu ChronoFlow 1",
          "home.visual.preview2.title": "Vue analytique",
          "home.visual.preview2.desc": "Analysez vos statistiques et suivez vos progrès avec des graphiques clairs et dynamiques.",
          "home.visual.preview2.alt": "Aperçu ChronoFlow 2",
          "home.visual.preview3.title": "Organisation des tâches",
          "home.visual.preview3.desc": "Organisez vos tâches et priorisez vos journées pour une productivité optimale.",
          "home.visual.preview3.alt": "Aperçu ChronoFlow 3", "home.visual.goToPreview": "Aller à l'aperçu {{number}}",
          // Export
          "export.title": "Exporter les tâches",
          "export.format": "Format d'export",
          "export.csv": "CSV (Tableur)",
          "export.pdf": "PDF (Document)",
          "export.report": "Rapport de productivité",
          "export.tasksCount": "tâches à exporter",
          "export.export": "Exporter",
          "export.exporting": "Export en cours...",
          "export.task": "Tâche",
          "export.description": "Description",
          "export.status": "Statut",
          "export.priority": "Priorité",
          "export.duration": "Durée",
          "export.created": "Créée le",
          "export.updated": "Mise à jour",
          // Common
          "common.cancel": "Annuler",
        },
      },
      en: {
        translation: {
          "header.product": "Product",
          "header.pricing": "Pricing",
          "header.resources": "Resources",
          "header.dashboard": "Dashboard",
          "header.login": "Login",
          "header.signup": "Sign Up",
          "header.logout": "Logout",
          // Footer
          "footer.product": "Product",
          "footer.pricing": "Pricing",
          "footer.resources": "Resources",
          "footer.help": "Help",
          "footer.faq": "FAQ",
          "footer.contact": "Contact",
          "footer.legal": "Legal",
          "footer.legalNotice": "Legal Notice",
          "footer.privacyPolicy": "Privacy Policy",
          "footer.terms": "Terms of Service", "footer.rights": "All rights reserved.",
          // Authentication
          "auth.signup.title": "Create an account",
          "auth.signup.email": "Email",
          "auth.signup.emailInvalid": "Invalid email",
          "auth.signup.username": "Username",
          "auth.signup.usernameRequired": "Username required",
          "auth.signup.password": "Password",
          "auth.signup.passwordMinLength": "Password must be at least 8 characters long",
          "auth.signup.passwordFormat": "Password must contain uppercase, lowercase, number and special character",
          "auth.signup.confirmPassword": "Confirm password",
          "auth.signup.creating": "Creating...",
          "auth.signup.create": "Create an account",
          "auth.signup.success": "Account created successfully!",
          "auth.signup.hasAccount": "Already have an account?",
          "auth.signup.signIn": "Sign in", "auth.login.title": "Sign in",
          "auth.login.password": "Password",
          "auth.login.emailInvalid": "Invalid email",
          "auth.login.passwordMinLength": "Password must be at least 8 characters long",
          "auth.login.passwordFormat": "Password must contain uppercase, lowercase, number and special character",
          "auth.login.signing": "Signing in...",
          "auth.login.signIn": "Sign in",
          "auth.login.googleSignIn": "Sign in with Google",
          "auth.login.noAccount": "Don't have an account?",
          "auth.login.createAccount": "Create an account",
          "auth.loading": "Loading...",
          "auth.userNotConnected": "User not connected",
          // OAuth error messages
          "auth.errors.oauthInvalidGrant": "Google authentication error. Please try again.",
          "auth.errors.googleAuthError": "Error during Google authentication.",
          "auth.errors.authFailed": "Authentication failed.",
          "auth.errors.missingCode": "Authorization code missing.",
          "auth.errors.unknown": "An error occurred during authentication.",
          // Features
          "features.title": "Key Features",
          "features.timerTitle": "Smart Timer",
          "features.timerDesc": "Start, stop, and track your time easily.",
          "features.tasksTitle": "Task Management",
          "features.tasksDesc": "Organize your tasks and prioritize your days.",
          "features.statsTitle": "Visual Statistics",
          "features.statsDesc": "See your progress with clear charts.",
          "features.calendarTitle": "Google Calendar Integration",
          "features.calendarDesc": "Sync your events and tasks.",
          "features.securityTitle": "Secure Backup",
          "features.securityDesc": "Your data is protected and backed up.",
          // Hero
          "hero.title": "Manage your time and tasks efficiently with ChronoFlow",
          "hero.subtitle": "ChronoFlow is the modern solution to organize your days, track your projects, and boost your productivity. Enjoy an intuitive interface, optimal security, and simplified time management—anywhere, anytime.",
          "hero.cta": "Create an account",
          // How it works
          "howitworks.title": "How does it work?",
          "howitworks.step1Title": "Start the timer",
          "howitworks.step1Desc": "Launch your work session in one click.",
          "howitworks.step2Title": "Add your tasks",
          "howitworks.step2Desc": "Write down and organize your tasks to accomplish.",
          "howitworks.step3Title": "Analyze your progress",
          "howitworks.step3Desc": "Check your stats and improve yourself.",
          // Sidebar & Dashboard navigation
          "sidebar.workspace": "Workspace",
          "sidebar.organization": "Organization",
          "sidebar.settings": "Settings",
          "sidebar.subscription": "Subscription",
          "sidebar.navigation": "Navigation",
          "sidebar.account": "Account",
          "sidebar.dashboard": "Dashboard",
          "sidebar.calendar": "Calendar",
          "sidebar.timer": "Timer",
          // Calendar
          "calendar.today": "Today",
          "calendar.yesterday": "Yesterday",
          "calendar.thisWeek": "This week - W{week}",
          "calendar.lastWeek": "Last week - W{week}",
          "calendar.custom": "Custom date",
          "calendar.next": "Next week",
          "calendar.prev": "Previous week",
          "calendar.calendar": "Calendar",
          "calendar.listView": "List view",
          "calendar.timesheet": "Timesheet",
          // Dashboard
          "dashboard.welcome": "Welcome to your workspace",
          "dashboard.calendar": "Calendar",
          "dashboard.tasks": "Tasks",
          "dashboard.focusZone": "Focus Zone",
          "dashboard.focus": "Focus", "dashboard.import": "Import",
          "dashboard.importCalendar": "Import calendar",
          "dashboard.export": "Export",
          "dashboard.exportTasks": "Export tasks",
          "dashboard.calendarPlaceholder": "Calendar loading...",
          "dashboard.getInTheZone": "Get in the zone",
          "dashboard.focusMessage": "Stay focused and avoid distractions. You are in the zone!",
          // Calendar translations
          "dashboard.calendar.title": "Calendar",
          "dashboard.calendar.view": "Calendar",
          "dashboard.calendar.importGoogle": "Import Google",
          "dashboard.calendar.today": "Today",
          "dashboard.calendar.month": "Month",
          "dashboard.calendar.week": "Week",
          "dashboard.calendar.day": "Day",
          "dashboard.calendar.list": "List",
          // Task translations
          "dashboard.tasks.title": "Title",
          "dashboard.tasks.description": "Description",
          "dashboard.tasks.color": "Color",
          "dashboard.tasks.chooseColor": "Choose color",
          "dashboard.tasks.create": "Create task",
          "dashboard.tasks.edit": "Edit task",
          "dashboard.tasks.delete": "Delete",
          "dashboard.tasks.cancel": "Cancel",
          "dashboard.tasks.save": "Save",
          "dashboard.tasks.list": "List",
          "dashboard.tasks.chooseColor": "Choisir la couleur",
          "dashboard.tasks.create": "Créer une tâche",
          "dashboard.tasks.edit": "Modifier la tâche",
          "dashboard.tasks.delete": "Supprimer",
          "dashboard.tasks.cancel": "Annuler",
          "dashboard.tasks.save": "Enregistrer",
          "dashboard.tasks.list": "Liste",
          "dashboard.taskStates": {
            "all": "Toutes",
            "active": "Actives",
            "completed": "Terminées"
          },
          "dashboard.loading": "Chargement...",

          // Tasks section
          "tasks.taskList": "Task List",
          "tasks.addTask": "Add Task",
          "tasks.editTask": "Edit Task",
          "tasks.taskTitle": "Task title",
          "tasks.taskDescription": "Task description (optional)",
          "tasks.noTasks": "No tasks to display.",
          "tasks.finish": "Finish",
          "tasks.completed": "Completed",
          "tasks.startTimer": "Start timer",
          "tasks.pauseTimer": "Pause",
          "tasks.resumeTimer": "Resume",
          "tasks.stopTimer": "Stop timer",

          // Timer
          "timer.title": "Timer",
          "timer.start": "Start",
          "timer.pause": "Pause",
          "timer.resume": "Resume",
          "timer.stop": "Stop",
          "timer.reset": "Reset",
          "timer.running": "Running",
          "timer.paused": "Paused",
          "timer.currentTask": "Current task",
          "timer.noTask": "No task selected",
          "timer.saveSession": "Save session",
          "timer.timeElapsed": "Time elapsed",
          "timer.taskTitle": "Task name",
          "timer.taskTitlePlaceholder": "Ex: Feature X development",
          "timer.taskDescription": "Description",
          "timer.taskDescriptionPlaceholder": "Details about the work done...",

          // Focus Zone
          "focusZone.title": "Focus Zone",
          "focusZone.searchPlaceholder": "Search for a task...",
          "focusZone.createNew": "Create a new task",
          "focusZone.newTaskPlaceholder": "New task name...",
          "focusZone.startWithoutTask": "Start without task",
          "focusZone.noResults": "No tasks found",

          // Dashboard focus translations
          "dashboard.focus.selectTaskFirst": "Please select a task first",
          "dashboard.focus.createTask": "Create a new task",
          "dashboard.focus.saveTask": "Save task",
          "dashboard.focus.backToList": "Back to list",

          // Calendar translations
          "dashboard.calendar.title": "Calendar",
          "dashboard.calendar.view": "Calendar",
          "dashboard.calendar.importGoogle": "Import Google",
          "dashboard.calendar.today": "Today",
          "dashboard.calendar.month": "Month",
          "dashboard.calendar.week": "Week",
          "dashboard.calendar.day": "Day",
          "dashboard.calendar.list": "List",

          // Task modal translations
          "dashboard.tasks.create": "Create a task",
          "dashboard.tasks.edit": "Edit task",
          "dashboard.tasks.title": "Title",
          "dashboard.tasks.description": "Description",
          "dashboard.tasks.color": "Color",
          "dashboard.tasks.chooseColor": "Choose color",
          "dashboard.tasks.delete": "Delete",
          "dashboard.tasks.cancel": "Cancel",
          "dashboard.tasks.save": "Save",
          "dashboard.tasks.list": "List",
          // Export
          'export.errorLoadingLib': 'Error loading export libraries. Please try again.',
          'export.exportError': 'Export failed. Please try again.',
          'export.title': 'Export Tasks',
          'export.format': 'Export Format',
          'export.csv': 'CSV (Spreadsheet)',
          'export.pdf': 'PDF (Document)',
          'export.report': 'Productivity Report',
          'export.tasksCount': '{{count}} tasks to export',
          'export.export': 'Export',
          'export.cancel': 'Cancel',
          'export.exporting': 'Exporting...',
          'export.csvDesc': 'Simple format for Excel/Google Sheets analysis',
          'export.pdfDesc': 'Formatted document, ideal for archiving',
          'export.reportDesc': 'Detailed report with analytics and statistics',
          // Common
          "common.optional": "optional",
          "common.cancel": "Cancel",
          "common.save": "Save",
          "common.saving": "Saving...",
          "common.update": "Update",
          "common.delete": "Delete",
          "common.close": "Close",
          "common.color": "Color",
          "common.start": "Start",
          "common.end": "End",
          // Task actions
          "task.complete": "Complete task",
          "task.completed": "Completed",
          // Timer actions
          "timer.start": "Start",
          "timer.play": "Play",
          "timer.pause": "Pause",
          "timer.resume": "Resume",
          "timer.stop": "Stop",
          "project.time": "Time",
          // Settings
          settings: {
            title: 'Settings',
            userProfile: 'User Profile',
            preferences: 'Preferences',
            security: 'Security',
            integrations: 'Integrations',
            support: 'Support',
            others: 'Others',
            items: {
              name: 'Name',
              email: 'Email',
              password: 'Password',
              language: 'Language',
              languageDesc: 'Choose your preferred language for the interface',
              languageChanged: 'Language changed successfully',
              languageChangeError: 'Error changing language',
              notifications: 'Notifications',
              notificationsDesc: 'Receive notifications for your tasks and reminders',
              notificationsEnabled: 'Notifications enabled',
              notificationsDisabled: 'Notifications disabled',
              notificationsOn: 'Enabled',
              notificationsOff: 'Disabled',
              profileLoadError: 'Error loading profile',
              usernameRequired: 'Username is required',
              usernameUpdated: 'Username updated successfully',
              usernameUpdateError: 'Error updating username',
              emailNotEditable: 'Not editable',
              twoFactorAuth: 'Two-Factor Authentication',
              connectedDevices: 'Connected Devices',
              loginHistory: 'Login History',
              connectGoogleCalendar: 'Connect Google Calendar',
              managePermissions: 'Manage permissions',
              reset: 'Reset',
              save: 'Save',
              edit: 'Edit',
              createdAt: 'Created At',
              lastSignInAt: 'Last Sign-In At',
              oldPassword: 'Old password',
              newPassword: 'New password',
              confirmPassword: 'Confirm password',
              changePassword: 'Change password',
              changePasswordDesc: 'Change your password to secure your account',
              allFieldsRequired: 'All fields are required',
              passwordMismatch: 'Passwords do not match',
              passwordTooShort: 'Password must be at least 6 characters',
              passwordChanged: 'Password changed successfully',
              passwordChangeError: 'Error changing password',
              googleCalendarConnected: 'Google Calendar connected successfully!',
              googleCalendarDisconnected: 'Google Calendar disconnected successfully.',
              googleCalendarError: 'Error connecting to Google Calendar.',
              disconnectGoogleCalendar: 'Disconnect Google Calendar',
              faq: 'FAQ',
              faqDesc: 'Find answers to frequently asked questions',
              documentation: 'Documentation',
              documentationDesc: 'Consult the complete ChronoFlow documentation',
              contactSupport: 'Contact Support',
              contactSupportDesc: 'Contact our support team for assistance',
              exportData: 'Export Data',
              exportDataDesc: 'Download all your personal data (tasks, work time, settings) in JSON format.',
              deleteData: 'Delete Data',
              deleteDataDesc: 'Permanently delete all your data. This action is irreversible.',
              deleteWarning: 'Warning',
              deleteWarningText: 'This action will permanently delete all your data. Type "DELETE" to confirm.',
              deleteConfirmError: 'Please type "DELETE" to confirm',
              exportSuccess: 'Data exported successfully',
              exportError: 'Error exporting data',
              deleteSuccess: 'Data deleted successfully',
              deleteError: 'Error deleting data',
              exporting: 'Exporting...',
              deleting: 'Deleting...',
              confirmDelete: 'Confirm deletion',
              openLink: 'Open',
              openForm: 'Contact',
              subject: 'Subject',
              message: 'Message',
              subjectPlaceholder: 'Subject of your message',
              messagePlaceholder: 'Describe your question or problem...',
              emailPlaceholder: 'your@email.com',
              contactFormError: 'Please fill in all fields',
              contactSuccess: 'Message sent successfully. We will respond to you as soon as possible.',
              contactError: 'Error sending message. Please try again.',
              sending: 'Sending...',
              sendMessage: 'Send',
            },
          },
          // Google Calendar
          googleCalendar: {
            title: 'Google Calendar',
            description: 'Connect your Google Calendar account to sync your tasks.',
            connect: 'Connect Google Calendar',
            connecting: 'Connecting...',
            connected: 'Google Calendar connected',
          },
          // Visual preview section
          "home.visual.preview1.title": "Time Management",
          "home.visual.preview1.desc": "Visualize and control your work time with the intuitive timer interface.",
          "home.visual.preview1.alt": "ChronoFlow Preview 1",
          "home.visual.preview2.title": "Analytics View",
          "home.visual.preview2.desc": "Analyze your stats and track your progress with clear, dynamic charts.",
          "home.visual.preview2.alt": "ChronoFlow Preview 2",
          "home.visual.preview3.title": "Task Organization",
          "home.visual.preview3.desc": "Organize your tasks and prioritize your days for optimal productivity.",
          "home.visual.preview3.alt": "ChronoFlow Preview 3",
          "home.visual.goToPreview": "Go to preview {{number}}",
          // Export
          "export.title": "Export Tasks",
          "export.format": "Export Format",
          "export.csv": "CSV (Spreadsheet)",
          "export.pdf": "PDF (Document)",
          "export.report": "Productivity Report",
          "export.tasksCount": "tasks to export",
          "export.export": "Export",
          "export.exporting": "Exporting...",
          "export.task": "Task",
          "export.description": "Description",
          "export.status": "Status",
          "export.priority": "Priority",
          "export.duration": "Duration",
          "export.created": "Created",
          "export.updated": "Updated",
          // Common
          "common.cancel": "Cancel",
          // FAQ
          "faq.title": "Frequently Asked Questions",
          "faq.subtitle": "Find quick answers to your questions about ChronoFlow",
          "faq.question1": "How does ChronoFlow work?",
          "faq.answer1": "ChronoFlow allows you to manage your time and tasks simply. Start the timer to track your work time, create and organize your tasks, then check your statistics to improve your productivity. Everything is designed to be intuitive and efficient.",
          "faq.question2": "Is my data protected?",
          "faq.answer2": "Yes, your data is stored in Europe and protected in accordance with GDPR. We use advanced security protocols and your personal information is never shared with third parties.",
          "faq.question3": "How can I contact the team?",
          "faq.answer3": "You can write to us via the Contact page or by email at contact.chronoflow@gmail.com. Our team usually responds within 24 hours.",
          "faq.question4": "Can I sync ChronoFlow with Google Calendar?",
          "faq.answer4": "Absolutely! ChronoFlow offers complete integration with Google Calendar. You can sync your events, create tasks directly from your appointments, and track time spent on each calendar activity.",
          "faq.question5": "Is ChronoFlow free?",
          "faq.answer5": "ChronoFlow offers a free version with essential features: timer, basic task management, and simple statistics. For advanced features like Google Calendar integration, detailed reports, and team collaboration, we offer affordable premium plans.", "faq.noAnswer": "Can't find your answer?",
          "faq.contactTeam": "Our team is here to help you. Don't hesitate to contact us!",
          "faq.contactButton": "Contact us",
          // Home components
          "home.faq.title": "Frequently Asked Questions",
          "home.faq.subtitle": "Find answers to the most common questions about ChronoFlow",
          "home.faq.question1": "Is ChronoFlow available in English?",
          "home.faq.answer1": "Yes, you can click on the flag and enjoy the features in English. The interface automatically adapts to your preferred language.",
          "home.faq.question2": "Is my data secure?",
          "home.faq.answer2": "Your data is stored in Europe and protected according to GDPR standards. We use end-to-end encryption and secure servers to ensure the confidentiality of your information.",
          "home.faq.question3": "Can I connect my Google Calendar?",
          "home.faq.answer3": "Yes, Google Calendar integration is available to synchronize your events. You can import your appointments and automatically sync your schedule.",
          "home.faq.moreQuestions": "Have more questions?",
          "home.faq.contactUs": "Contact us",
          "home.testimonials.title": "They use ChronoFlow",
          "home.testimonials.testimonial1.text": "\"ChronoFlow helps me stay focused and better manage my days.\"",
          "home.testimonials.testimonial1.name": "Alice, Freelancer",
          "home.testimonials.testimonial2.text": "\"The interface is super intuitive, I recommend it 100%.\"",
          "home.testimonials.testimonial2.name": "Karim, Student",
          "home.testimonials.testimonial3.text": "\"The statistics are great for tracking my progress.\"",
          "home.testimonials.testimonial3.name": "Sophie, Manager",
          "home.cta.title": "Ready to boost your productivity?",
          "home.cta.subtitle": "Try ChronoFlow for free today.",
          "home.cta.button": "Create an account",
        },
      },
    },
    lng: initialLang,
    fallbackLng: "fr",
    interpolation: { escapeValue: false },
  });

// Synchronise la langue i18n avec la route à chaque navigation
if (typeof window !== "undefined") {
  // Listen for URL changes
  window.addEventListener("popstate", () => {
    const lang = detectLanguage();
    if (i18n.language !== lang) i18n.changeLanguage(lang);
  });

  // Listen for URL query parameter changes
  const originalPushState = history.pushState;
  const originalReplaceState = history.replaceState;

  history.pushState = function () {
    originalPushState.apply(history, arguments);
    setTimeout(() => {
      const lang = detectLanguage();
      if (i18n.language !== lang) i18n.changeLanguage(lang);
    }, 0);
  };

  history.replaceState = function () {
    originalReplaceState.apply(history, arguments);
    setTimeout(() => {
      const lang = detectLanguage();
      if (i18n.language !== lang) i18n.changeLanguage(lang);
    }, 0);
  };
}

// Listen for language changes and persist to localStorage
i18n.on('languageChanged', (lng) => {
  if (typeof window !== "undefined") {
    localStorage.setItem('preferred-language', lng);
  }
});

export default i18n;
